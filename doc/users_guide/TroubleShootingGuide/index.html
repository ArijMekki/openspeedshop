<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Open Speed Shop: Open/SpeedShop TroubleShooting Guide</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindexHL" href="index.html">Main&nbsp;Page</a></div>
<h1>Open/SpeedShop TroubleShooting Guide </h1>
<p>
<h3 align="center">0.0.1 </h3><h2><a class="anchor" name="section1">
A. OVERVIEW</a></h2>
Two major pieces of 3rd-party software provide much of the infrastructure for Open/SpeedShop:<p>
DPCL: <a href="http://www-124.ibm.com/developerworks/opensource/dpcl">http://www-124.ibm.com/developerworks/opensource/dpcl</a><p>
Dyninst: <a href="http://www.dyninst.org">http://www.dyninst.org</a><p>
The centerpiece of Open/SpeedShop's functionality is its ability to perform 'dynamic instrumentation' (Dyninst) of a user's target application on a node-to-node (DPCL) basis across a 'cluster' of 'nodes'. Dyninst provides the dynamic instrumentation ability and DPCL allows this unique ability to be transported between cluster nodes. (See webpages cited above for further details). This Guide's purpose is to assist a Open/SpeedShop newcomer by providing some useful tips to ease the process of installing, setting up, and using Open/SpeedShop. The focus is on ensuring proper network connectivity, proper Open/SpeedShop installation and, finally, proper user setup. All three of these areas have exact requirements that must be met to be successful using Open/SpeedShop.<h2><a class="anchor" name="section2">
B. USING Open/SpeedShop</a></h2>
Success in using Open/SpeedShop requires:<p>
<br>
 <h3><a class="anchor" name="subsection21">
&lt;==&gt; 1. Proper Network Connectivity</a></h3>
<br>
<p>
<br>
 <dl compact><dt><b>o The extended Internet services daemon 'xinetd' must be running and properly configured for each 'node'. </b></dt><dd><br>
 Check the '/etc/xinetd.conf' file for correct 'xinetd' configuration. The webpage <a href="http://www.xinetd.org">http://www.xinetd.org</a> has pertinent configuration details. If 'xinetd' is not running, then check the file '/etc/sysconfig/network' to ensure that 'NETWORKING=yes' is specified and then do the following:</dd></dl>
<pre><div>
       /etc/rc.d/init.d/xinetd start    
 </pre></div><p>
<pre><div></pre></div><p>
<pre><div>       Example of '/etc/xinetd.conf' file:</pre></div><p>
<pre><div>           #
           # Simple configuration file for xinetd
           #
           # Some defaults, and include /etc/xinetd.d/</pre></div><p>
<pre><div>           defaults
           {
           instances               = 60
           log_type                = SYSLOG authpriv
           log_on_success          = HOST PID
           log_on_failure          = HOST
           cps                     = 25 30
           }
           includedir /etc/xinetd.d</pre></div><p>
<pre><div>       It is essential that the /etc/xinetd.d directory is included. This is not optional.
 </pre></div><p>
<br>
 <dl compact><dt><b>o When using DNS (nameservers), an '/etc/resolv.conf' file must be present for each 'node'.</b></dt><dd><br>
 This file is not necessary if there is a name server running on the *local 'node' and the hostname contains the domain name. It is necessary,however, if the system administrator wants to override the default ordering of the host lookup services.</dd></dl>
<br>
<p>
<pre><div>
       Example of '/etc/resolv.conf file:</pre></div><p>
<pre><div>           search foo.bar.com
           nameserver 128.162.236.210
           nameserver 128.162.237.211
           nameserver 137.38.31.248
 </pre></div> <br>
 <dl compact><dt><b>o If not using DNS(nameservers), the '/etc/hosts' file must be present. </b></dt><dd><br>
 This file is a simple text file that associates IP addresses with hostnames.</dd></dl>
<br>
<p>
<pre><div>
       Example of an '/etc/hosts' file:</pre></div><p>
<pre><div>           # Do not remove the following line, or various programs
           # that require network functionality will fail.
           127.0.0.1         localhost.localdomain localhost
           128.162.243.146   foo.bar.com foo
 </pre></div> <br>
 <dl compact><dt><b>o Use the 'ping' command to confirm connectivity between all nodes in a cluster.</b></dt><dd><br>
 If one 'node' can 'ping' another 'node', then basic network connectivity is in place between those two nodes. For example, if a user has 'logged in' to 'node1', then the following command issued from 'node1' will test proper network connectivity between 'node1' and, e.g., 'foo.bar.com':</dd></dl>
<pre><div>
                       'ping foo.bar.com'</pre></div><p>
<pre><div>       Example of good 'ping' output:</pre></div><p>
<pre><div>       PING foo.bar.com (128.162.236.165): 56 data bytes
       64 bytes from 128.162.236.165: icmp_seq=0 ttl=63 time=1.056 ms
       64 bytes from 128.162.236.165: icmp_seq=1 ttl=63 time=1.481 ms
       64 bytes from 128.162.236.165: icmp_seq=2 ttl=63 time=1.430 ms
       64 bytes from 128.162.236.165: icmp_seq=3 ttl=63 time=1.440 ms
           ....</pre></div><p>
<pre><div>       Similarly, the 'ftp', 'telnet', and 'rsh' commands can be used to verify network connectivity between nodes. 
       If 'network unreachable' results from any of these commands, then connectivity issues between the nodes still exist.
 </pre></div><p>
<br>
 <dl compact><dt><b>o Routing must be set up properly so network traffic can get off the 'node'.</b></dt><dd><br>
 In a simple configuration with a single network card in each 'node', you can define a 'default route' such that all traffic goes thru that 'route'. An IP address is specified as the 'default route'. The command '/sbin/route' summarizes the current IP routing table for a 'node' and the command 'route' (man 'route') can be used to manipulate this table.</dd></dl>
<pre><div>
       Example of '/sbin/route' output:</pre></div><p>
<pre><div>           Kernel IP routing table                                                         
           Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
           128.162.243.0   *               255.255.255.0   U     0      0        0 eth0
           169.254.0.0     *               255.255.0.0     U     0      0        0 eth0
           127.0.0.0       *               255.0.0.0       U     0      0        0 lo
           default         e-10-13-hs1-243 0.0.0.0         UG    0      0        0 eth0
 </pre></div><p>
<br>
 <dl compact><dt><b>o Working network interface must exist for each 'node' with an assigned IP address.</b></dt><dd><br>
 The command 'ifconfig' (do 'man ifconfig') helps setup this interface and the command '/sbin/ifconfig' summarizes the current network interface for each 'node'. See also the webpage: <a href="http://www.computerhope.com/unix/uifconfi.htm">http://www.computerhope.com/unix/uifconfi.htm</a> for more details regarding 'ifconfig'.</dd></dl>
<pre><div>
       Example of '/sbin/ifconfig' output:</pre></div><p>
<pre><div>           eth0      Link encap:Ethernet  HWaddr 08:00:69:13:EB:CB  
           inet addr:128.162.243.146  Bcast:128.162.243.255  Mask:255.255.255.0
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:1526380 errors:0 dropped:0 overruns:0 frame:0
           TX packets:375501 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:100 
           RX bytes:205612453 (196.0 Mb)  TX bytes:119995458 (114.4 Mb)
           Interrupt:57</pre></div><p>
<pre><div>           lo        Link encap:Local Loopback  
           inet addr:127.0.0.1  Mask:255.0.0.0
           UP LOOPBACK RUNNING  MTU:16436  Metric:1
           RX packets:318139 errors:0 dropped:0 overruns:0 frame:0
           TX packets:318139 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:0 
           RX bytes:42295160 (40.3 Mb)  TX bytes:42295160 (40.3 Mb)
 </pre></div> <br>
<h3><a class="anchor" name="subsection22">
&lt;==&gt; 2. Proper Network Open/SpeedShop Installation</a></h3>
<br>
<p>
<dl compact><dt><b>o An identical copy of Open/SpeedShop must be installed on all nodes in a cluster</b></dt><dd><br>
 where the DPCL client or a target application will run under DPCL control. Refer to &lt;Open/SpeedShop's installation documentation&gt;. Once the installation has been done, the user can verify correctness in a variety of ways. But first, a brief discussion about two major pieces of DPCL that are installed on a node: the SuperDaemon ('ps' command will show 'dpclSD' upon activation) and the DPCL CommunicationsDaemon ('ps' command will show 'dpcld' upon activation).</dd></dl>
<br>
 <dl compact><dt><b>o A single DPCL SuperDaemon('dpclSD') runs on each 'node' in a cluster.</b></dt><dd><br>
 When the first SuperDaemon starts as a result of a user's request for DPCL functionality, it obtains a lock and holds that lock as long as it is running. Additional DPCL user 'connect' requests to the same 'node' result in additional DPCL SuperDaemons being created, but these additional SuperDaemons cannot obtain the lock and transfer the 'connection' to the first DPCL SuperDaemon and exit. The DPCL SuperDaemon invokes a single DPCL 'CommunicationsDaemon ('dpcld') for each userid when that user actually utilizes any DPCL functionality. Part of the DPCL user 'connection' processing is to have shared memory segments established between the CommunicationsDaemon and a user's application (target process). Architecture-specific 'locking' code prevents the CommunicationsDaemon and target processe from simultaneously updating shared structures.</dd></dl>
<br>
 <dl compact><dt><b>o An entry for the DPCL SuperDaemon must exist in '/etc/services'. </b></dt><dd><br>
 If you are not seeing a line in '/etc/services' for service dpclSD, then 'xinetd' won't be listening to the SuperDaemon port and DPCL won't work.</dd></dl>
<pre><div>
       Example of the SuperDaemon '/etc/services' entry:</pre></div><p>
<pre><div>          dpclSD      7895/tcp             # DPCL Super Daemon 
 </pre></div><p>
<br>
 <dl compact><dt><b>o A file named '/etc/xinetd.d/dpclSD' must exist to specify the DPCL SuperDaemon service via 'xinetd'. </b></dt><dd><br>
 An 'unofficial' tutorial on 'xinetd' and what the various entries in a 'service section' indicate can be found at: <a href="http://www.macsecurity.org/resources/xinetd/.">http://www.macsecurity.org/resources/xinetd/.</a> Of particular concern for Open/SpeedShop installation, are the 'server', 'server_args', and 'env' entries. Open/SpeedShop installation must copy a DPCL SuperDaemon binary('dpclSD') to the location specified in the 'server' entry. The 'server_args' entry specifies the location of the CommunicationsDaemon binary('dpcld') which will be 'execd' by the SuperDaemon with two arguments to specify a default 'Unix name' of the 'execd' CommunicationsDaemon and a 'default log name' for debug logfiles created by the CommunicationsDaemon. Finally, the 'env' entry must update the environment variables 'LD_LIBRARY_PATH', 'DPCL_RT_LIB', and 'DYNINST_RT_LIB' to include the path to the directories where the DPCL and Dyninst runtime libraries are installed.</dd></dl>
<pre><div>
       Example of '/etc/xinetd.d/dpclSD'</pre></div><p>
<pre><div>       service dpclSD
       {
            disable = no
            socket_type = stream
            protocol = tcp
            wait = no
            user = root
            server = /perftools/ROOT/bin/dpclSD
            server_args = /perftools/ROOT/bin/dpcld /tmp/dpcld /tmp/dpcl
            env += LD_LIBRARY_PATH=/perftools/ROOT/lib
            env += DPCL_RT_LIB=/perftools/ROOT/lib/libdpclRT.so.1
            env += DYNINSTAPI_RT_LIB=/perftools/ROOT/lib/libdyninstAPI_RT.so.1
       }
 </pre></div> <br>
 <dl compact><dt><b>o The 'xinetd' daemon must be restarted at some point following Open/SpeedShop installation.</b></dt><dd><br>
 Doing so allows 'xinetd' to pick up the SuperDaemon(dpclSD) service and start 'listening' on its port. This restart can be done manually as 'root' user by first doing 'ps -ef | grep xinetd' to get the 'xinetd' 'pid'. The signals for restarting 'xinetd' vary somewhat by operating system . Some versions require 'kill -USR2 'pid'' where 'pid' is the pid resulting from the 'ps' command. It is also possible to do either 'kill -9 xinetd' or simply reboot the 'node'. Other Linux system possibilities are: kill -USR1 `cat /var/run/xinetd.pid`' or 'kill -SIGHUP `cat /var/run/xinetd.pid`'. When 'xinetd' is restarted, lines similar to the following should appear in the system file '/var/log/messages':</dd></dl>
<pre><div></pre></div><p>
<pre><div>       .... xinetd[617]: Starting reconfiguration</pre></div><p>
<pre><div>       .... xinetd[617]: readjusting service dpclSD
 </pre></div><p>
<br>
 <dl compact><dt><b>o Confirm that 'xinetd' is listening to the DPCL SuperDaemon port.</b></dt><dd><br>
 The following command can be used:</dd></dl>
<pre><div>
                       'netstat -a --inet'</pre></div><p>
<pre><div>       If 'xinetd' is listening to the DPCL SuperDaemon port, a line similar to the following
       should result from the 'netstat' command:</pre></div><p>
<pre><div>           tcp        0      0 *:dpclSD                *:* LISTEN</pre></div><p>
<pre><div>       The purpose of setting up the 'etc/services' file correctly, restarting 'xinetd', and
       so forth, is to ensure the SuperDaemon(dpclSD) service is 'listening' for traffic on its
       designated port. Any node where it is intended to run a target program must have been
       configured so that the SuperDaemon(dpclSD) service is in the 'listening' state. To further
       confirm that the system is listening to the SuperDaemon service correctly, the following 
       command can be tried (where 7895 is the port number of the SuperDaemon as verified above
       in the '/etc/services' file):</pre></div><p>
<pre><div>           telnet foo.bar.com 7895</pre></div><p>
<pre><div>       The 'telnet' command tries to connect to the 7895 port via telnet protocol and 'xinted'
       will bring up the SuperDaemon(dpclSD) if it can load the DPCL client libraries, etc. A 
       simple 'ps' command should show 'dpclSD' running if the 'telnet' command was successful.
       If 'netstat' isn't indicating the system is listening on the dpclSD service (or port 7895),
       then a "connection refused" status will be given, e.g:</pre></div><p>
<pre><div>           telnet foo.bar.com 7895
           Trying 128.162.243.146...
           telnet: connect to address 128.162.243.146: Connection refused</pre></div><p>
<pre><div>       Just getting "connection refused", however, indicates, at a minimum, that the network 
       is properly connected.</pre></div><p>
<pre><div>       Unfortunately, just observing all the above to be correct does not guarantee that the
       'xinetd' is working properly. It has been observed that flaky hardware 'router' problems
       will cause things to not work, even though 'xinetd' is listening and has been restarted.
       Sometimes the only solution is a reboot of the entire system.
 </pre></div><p>
<br>
 <dl compact><dt><b>o DPCL security system config file '/opt/dpcl/etc/dpcl.config' must be present. </b></dt><dd><br>
 This file is owned by 'root' user and its contents are globally available. This security mechanism is relevant only to IBM users of DPCL. It can be ignored by non-IBM users, but the file itself must be present, with contents as follows:</dd></dl>
<br>
 <pre><div>
      security:
          method = dpcl</pre></div><p>
<pre><div>       With "method = ctsec", relevant only to IBM users, DPCL will 'dlopen' a special library. 
 </pre></div><p>
<br>
 <h3><a class="anchor" name="subsection23">
&lt;==&gt; 3. Proper Network User Login and Environment</a></h3>
<br>
<p>
<br>
 <dl compact><dt><b>o A '.rhosts' file must exist in the user's home directory with a line for each host/user</b></dt><dd><br>
 the user wants to allow to connect to the user's node. The file also needs to be owned by the user with permissions 0644. This can be verified by trying a 'rsh' command, assuming 'rsh' daemons are up and running on the cluster 'nodes' in question..</dd></dl>
<pre><div>
       Example of '.rhosts' file:</pre></div><p>
<pre><div>       foo.bar.com userlogin
       foo1.bar.com userlogin
       foo2.bar.com userlogin
</pre></div><p>
<br>
 <dl compact><dt><b>o A 'full path' must be specified at the time of execution for a user's target application. </b></dt><dd><br>
 Otherwise a DPCL error will result (see 'Common Errors' section below).</dd></dl>
<br>
 <dl compact><dt><b>o The user must set certain environment variables for successful target compilation and execution</b></dt><dd><br>
 using Open/SpeedShop. These environement variables point to necessary loadtime/runtime/etc libraries used by the two largest underlying components of Open/SpeedShop: Dyninst and DPCL (see 'INTRODUCTION. above). The user's '.login' file can do the following command:</dd></dl>
<pre><div>
         'source /perftools/ROOT/setenv.csh'</pre></div><p>
<pre><div>          This '.csh' file contains:</pre></div><p>
<pre><div>               #########################################################################
               Ensure PATH, LD_LIBRARY_PATH, MANPATH, and CPPFLAGS have initial value
               #########################################################################
               if ($?PATH == "0") setenv PATH ""
               if ($?LD_LIBRARY_PATH == "0") setenv LD_LIBRARY_PATH ""
               if ($?MANPATH == "0") setenv MANPATH ""
               if ($?CPPFLAGS == "0") setenv CPPFLAGS ""
               #########################################################################
               Set necessary environment variables to use ROOT directory
               #########################################################################
               setenv ROOT "/perftools/ROOT"
               setenv QTDIR "$ROOT"
               setenv PATH "$ROOT/bin:$PATH"
               setenv LD_LIBRARY_PATH "$ROOT/lib:$LD_LIBRARY_PATH"
               setenv MANPATH "$ROOT/man:$MANPATH"
               setenv CPPFLAGS "-I$ROOT/include $CPPFLAGS"
</pre></div><p>
<br>
 <dl compact><dt><b>o The same 'userid' must be invoked at 'login' time on each 'node' in the cluster</b></dt><dd><br>
 where Open/SpeedShop will be utilized, locally or remotely from another 'node'. Otherwise a DPCL error will result (see 'Common Errors' section below). What this means, for example, is that a user expecting to 'login' on 'node1' as 'fred' and use Open/SpeedShop to dynamically instrument the user's target application 'foo' on 'node2', must 'login' to 'node2' as 'fred' as well.</dd></dl>
<br>
 <dl compact><dt><b>o A user cannot run as 'superuser' or 'root' user. This is a security precaution by the DPCL component of Open/SpeedShop.</b></dt><dd><br>
</dd></dl>
<br>
 <dl compact><dt><b>o Proper compilation and linkage of a user's target application has specific requirements</b></dt><dd><br>
 if Open/SpeedShop will be 'connecting' to it. A sample 'Makefile' for 64-bit Linux C/C++ (below) illustrates the need for accessing the required include files, libraries, predefines, and so forth.</dd></dl>
<pre><div>
       Example Makefile for 64-bit Linux C/C++ :</pre></div><p>
<pre><div>              --begin Makefile</pre></div><p>
<pre><div>                 .SUFFIXES:      .C 
                 code=sample
                 ROOT=/perftools/ROOT
                 INCDIR	= /perftools/ROOT/include/dpcl
                 INC	= -I
                 LIBLOC	= -L /perftools/ROOT/lib
                 LIB	= -ldpcl -lelf
                 CCFLAGS	= -pg -g -gdwarf_2 -D__64BIT__</pre></div><p>
<pre><div>                 all:	${code}</pre></div><p>
<pre><div>                 .C.o:
	                 -c $(&lt;)</pre></div><p>
<pre><div>                 ${code}:	${code}.o
	               -o ${code} ${code}.o  </pre></div><p>
<pre><div>                 clean:
	              /bin/rm -rf ${code} .o</pre></div><p>
<pre><div>              --end Makefile
</pre></div><p>
<br>
 <dl compact><dt><b>o Any leftover DPCL SuperDaemons or CommunicationsDaemons from previous executions must be killed.</b></dt><dd><br>
 Orderly termination of DPCL daemons can be problematic at times due to the many variables involved. Failure to get rid of orphaned copies of the SuperDaemon/CommunicationsDaemon may result in a 'hang' condition, whereby a DPCL 'mutator', upon initial startup, just seems to be hung and not accumulating time. This is because 'xinetd' has disallowed any additional SuperDaemon/CommunicationsDaemon combinations to be started. The 'xinetd' service associated with the SuperDaemon has reached a 'xinted' resource limit. The following two successive commands can be used to, first, see if any undesirable leftover DPCL processes exist prior to beginning a new Open/SpeedShop work session and, secondly, to remove them:</dd></dl>
<pre><div>
                       'ps -ef | grep dpcl*'</pre></div><p>
<pre><div>                       'pkill -9 dpcl'
</pre></div><h2><a class="anchor" name="section3">
C. ERRORS</a></h2>
The two major 3rd party software pieces that form the infrastructure for Open/SpeedShop (see 'OVERVIEW' above) are able to detect, and allow the user to recover from, a number of error situations when dealing with the complex problem of transporting dynamic instrumentation across several nodes in a cluster. These 'recoverable' errors can often be overcome with relative ease by the user and they are listed below. This same software, however, can sometimes unfortunately continue to the point of causing (e.g.) a SIGSTOP or SIGSEGV signal and recovery from these errors can be difficult. These 'other' errors sometimes require formal fixes or additions to the software and, accordingly, they are discussed in general terms only.<p>
<br>
 <h3><a class="anchor" name="subsection31">
&lt;==&gt; 1. Common 'Recoverable Errors'</a></h3>
<br>
<p>
<br>
 <dl compact><dt><b>o ASC_no_config_file</b></dt><dd><br>
 No DPCL security file (/opt/dpcl/etc/dpcl.config) can be found on the 'node' in question. See (USING Open/SpeedShop) section above regarding this necessary file and its contents.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_daisd_no_info_fserv</b></dt><dd><br>
 There is an obvious problem with setting up the DPCL SuperDaemon service. For example, no service entry for 'dpclSD' (the SuperDaemon) exists in file (/etc/services). Make sure each item listed above under 'Proper Network Installation for Open/SpeedShop' is satisfied.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_invalid_security_model</b></dt><dd><br>
 The DPCL security file (/opt/dpcl/etc/dpcl.config) exists on the 'node' in question, but its contents are not valid. See (USING Open/SpeedShop) section above regarding this necessary file and its contents.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_install_failed</b></dt><dd><br>
 This error occurs when a DPCL instrumentation probe cannot be installed. Often this is due to running out of DPCL's shared memory because each instrumentation probe requires a shared memory 'message handle'. The value of AIS_SHM_SIZE determines how much DPCL shared memory is allocated. A recompile of DPCL with a larger value for AIS_SHM_SIZE might be required. Long term thinking is to make determination of AIS_SHM_SIZE a runtime function. But for now it is a fixed constant set up in ~daemon/src/ShmUsage.C.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_invalid_version</b></dt><dd><br>
 This error occurs when running between nodes in a cluster. It says that the DPCL version you are running with on one node does not match the DPCL version running on the other node. See section titled 'Proper Network Open/SpeedShop Installation' where it is stated that an 'identical copy of Open/SpeedShop must be installed on all nodes' in a cluster.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_unknown_status.</b></dt><dd><br>
 This is a somewhat ambiguous error message that can often be associated with network 'connectivity' issues. See the section on 'Proper Network Connectivity' under the (USING Open/SpeedShop) heading and confirm that your network is properly connected between the 'nodes' in question.</dd></dl>
<br>
 <dl compact><dt><b>ASC_communication_failure:</b></dt><dd><br>
 This error often means either the DPCL SuperDaemon or the CommunicationsDaemon crashed or were not able to begin execution. If the SuperDaemon crashes, it will close the 'socket' for its connection to the DPCL library code on the 'client' side and this 'client' code will issue the error. The 'ldd' command can be used to verify that both daemons are finding all the necessary dynamic libraries necessary for them to run. Assuming that '/perftools/ROOT/bin' contains a binary for both the SuperDaemon and the Communications daemon, this command can be tried as follows:</dd></dl>
<pre><div></pre></div><p>
<pre><div>       'ldd /perftools/ROOT/bin/dpcld', or</pre></div><p>
<pre><div>       'ldd /perftools/ROOT/bin/dpclSD'</pre></div><p>
<pre><div>       If any dynamic library appears as 'unknown', then that would cause the above error to appear. Otherwise a 'non-recoverable' 
       error (see next section) could be the source of one of the DPCL daemons crashing. What's supposed to happen is that the 
       SuperDaemon either creates a DPCL CommunicationsDaemon process for a userid or finds an existing CommunicationsDaemon 
       for that userid and uses it. Messaging then passes an established socket connection between the client (Open/SpeedShop) and 
       the DPCL SuperDaemon. A 'broken pipe' status in conjunction with this error would indicate the DPCL CommunicationsDaemon 
       process has somehow disappeared, inplicitly closing its side of the pipe.</pre></div><p>
<pre><div>       Another source of the 'ASC_communication_failure' error occurs if copies of the 'mutatee' have been orphaned and 
       still exist. For example, assume the binary you are instrumenting has the name 'fred' (i.e. the 'mutatee' is
       named 'fred'). Following a run of the DPCL mutator which instruments 'fred', there may be copies of 'fred' 
       still visible via 'ps -ef | grep fred'. To clean things up, a 'pkill -9 fred' can be done. This might 
       very well eliminate the 'ASC_communication_failure'.</pre></div><p>
<pre><div>       Still another source of the 'ASC_communication_failure' error can occur because old DPCL shared memory has 
       not been released. DPCL uses shared memory in conjunction with installing instrumentation probes. 
       Enter the command 'ipcs'. This will yield something like:</pre></div><p>
<pre><div>          ------ Shared Memory Segments --------
          key        shmid      owner      perms      bytes      nattch     status
          0x4103b332 1703936    slc       600        268435456  1</pre></div><p>
<pre><div>       If any old shared memory segments are still out there for your userid, for example in this case 'slc' has old memory under 
       shmid 1703936 and it is a sizeable chunk of memory. It must be removed via the command 'ipcrm -m 1703936'.</pre></div><p>
<pre><div>       Still another source of the 'ASC_communication_failure' error occurs during 'connection' processing when the '.rhosts'
       file is not properly set up. See the Proper Network User Login and Environment section above.</pre></div><p>
<pre><div>       Still another source of the 'ASC_communication_failure' error occurs when trying to create a 'mutatee'.  If the path 
       to the 'mutatee' is incorrect, or if the arguments to the 'mutatee' are incorrect (try executing the 'mutatee' with the path 
       and arguments you know you are using), then this error will appear.
</pre></div><p>
<br>
 <dl compact><dt><b>o ASC_rhost_failed</b></dt><dd><br>
 Almost certainly this is an indication that the user's '.rhosts' file either does not exist on the 'node' in question or its contents do not reflect the desired connectivity. See the Proper Network User Login and Environment section above regarding the contents of '.rhosts'.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_daisd_cant_sock</b></dt><dd><br>
 This error message firmly indicates that the network has connectivity issues, most likely that the '/etc/services' file is improperly configured and the DPCL SuperDaemon service is not functional. See (USING Open/SpeedShop) above and try the suggestions in the Network Connectivity section, one at a time. Also, DPCL uses the Linux 'ruserok' security mechanism and if the call to 'ruserok' fails, then this error might appear. It would indicate a problem with the user's '.rhosts' file or the '/etc/hosts.equiv' file. See the *man page for 'ruserok'. documented in the man page.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_invalid_pid</b></dt><dd><br>
 Somehow DPCL has been asked to attach to a 'pid' on a 'node' that has no such process 'pid' active. Check that the 'pid' entered via Open/SpeedShop is actually that of the target application running on the desired 'node'. Also, the target application must be running under the same (non-root) userid as that under which Open/SpeedShop was invoked.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_missing_predef_func</b></dt><dd><br>
 DPCL has certain functions it needs to find in the library 'libdpclRT.so'. These functions are: 'shm_attach', 'shm_detach', 'Ais_phase_add', 'Ais_phase_deactivate', 'Ais_phase_set_period', 'Ais_phase_remove'. Somehow DPCL is not finding 'libdpclRT.so' via the environment variable LD_LIBRARY_PATH.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_missing_aout</b></dt><dd><br>
 This usually means that a 'full path' was not specified for the target application at the time it was initially executed. Terminate the currrently running copy of the target application and re-execute it using a 'full path' specification.</dd></dl>
<br>
 <dl compact><dt><b>o ASC_failure</b></dt><dd><br>
 This error has several points-of-origin, but one of the most easily remedied is that the user has not specified an accurate, full-path location for the target application when it was initially executed. The 'ASC_missing_aout' error above can also result from this user indiscretion, but so can this 'ASC_failure' error. The user can re-execute the target using an accurate, 'full path' specification.</dd></dl>
<pre><div></pre></div><p>
<pre><div>       Yet another source of this error is the improper setting of the environment variables LD_LIBRARY_PATH, 
       DPCL_RT_LIB, and  DYNINSTAPI_RT_LIB in the file '/etc/xinetd.d/dpclSD'. See the section on Proper Network 
       Installation of Open/Speedshop above for an example of a proper '/etc/xinetd.d/dpclSD' file.
</pre></div><p>
<br>
 <h3><a class="anchor" name="subsection32">
&lt;==&gt; 2. Non-recoverable Errors</a></h3>
<br>
<p>
<br>
 <dl compact><dt><b>o Runtime libraries </b></dt><dd><br>
 In order to implement dynamic instrumentation across nodes in a cluster, the user's target application is significantly 'mutated' or changed. First, it must have a couple runtime libraries brought into its address space. One such library exists for DPCL and one for Dyninst. Within Dyninst, there are places where the software simply generates an 'abort' because the circumstances are intractable and the software knows it has a problem. In other cases, Dyninst will unwittingly keep going with, for example, an improper index which eventually results in a memory access error. These 'other errors' in the Dyninst runtime library will manifest themselves in a couple different ways. First, the target application will simply die with (e.g.) a SIGSTOP or SIGSEGV signal. In addition, the DPCL layer of software will detect that the target application has died and the DPCL CommunicationsDaemon('dpcld') will shut down, resulting in (e.g.) an 'ASC_communiction_error' being delivered to the DPCL client portion of Open/SpeedShop. For the most part, the DPCL runtime library itself does not 'abort' when it recognizes an intractable situation, but rather 'messages' to the SuperDaemon('dpclSD'), the non-runtime portion of the CommunicationsDaemon('dpcld'), and the DPCL client portion of Open/SpeedShop that things need to be shut down. In this more-or-less orderly 'messaging' case, the user could see the CommunicationsDaemon shut down and the target application simply continuing on its way after off-loading all its 'mutated' portions. However, if a portion of DPCL unwittingly continues with (e.g.) an improper index, then an abort signal (e.g.) will be delivered, possibly 'hanging' the target application or causing some other undesirable result. The combinatorics are complex and, accordingly, the resulting error recovery can take many forms, almost all of which can be troublesome.</dd></dl>
<br>
 <dl compact><dt><b>o DPCL CommunicationsDaemon('dpcld')</b></dt><dd><br>
 This daemon has a couple components, one for Dyninst and one for DPCL itself. Similar to its 'runtime library' portion, the Dyninst non-runtime software within the DPCL CommunicationsDaemon can gracefully 'abort' if it knows it has a problem, or issue (e.g.) a SIGSEGV signal unwittingly. These Dyninst errors will likely cause the daemon to cease running with appropriate 'messages' to the Open/SpeedShop client and the DPCL SuperDaemon(dpclSD). The user's target application might continue running after off-loading its 'mutated' portions, or it might simply 'hang' due to some unknown combination of things, but the target application itself will not die.</dd></dl>
<br>
 <dl compact><dt><b>o Client-side</b></dt><dd><br>
 The 'client' portion of Open/SpeedShop has many pieces as well, including the 'client' portion of DPCL, the Open/SpeedShop 'framework', the Open/SpeedShop 'gui', and so forth. When this part of the software gets into an error situation with (e.g.) an improper index, then the user will likely see an error message displayed by Open/SpeedShop itself. In addition, the DPCL CommunicationsDaemon will detect that its client has problems and begin to shut down its side of things. Again, the combinatorics are complex and, accordingly, so is the error recovery on the client side of things. </dd></dl>
<hr size="1"><address style="align: right;"><small>Generated on Fri Mar 4 11:36:18 2005 for Open Speed Shop by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
