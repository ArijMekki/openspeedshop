<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!--
      Copyright (c) 2005 Silicon Graphics, Inc. All Rights Reserved.
      Permission is granted to copy, distribute and/or modify this document
      under the terms of the GNU Free Documentation License, Version 1.2
      or any later version published by the Free Software Foundation;
      with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
         Texts.  A copy of the license is included in the section entitled "GNU
      Free Documentation License".
-->
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>Building and Installing DPCL for advanced users</title>
</head>
<body>
<h3><a class="mozTocH3" name="mozTocId882423"></a><b style=""><a
 name="mozTocId556715" class="mozTocH2"></a>Building and Installing
DPCL - for advanced users<br>
</b></h3>
<blockquote><b style="">DPCL is the component responsible for
supporting
performance
measurement gathering on clusters.&nbsp; In a clustering configuration
DPCL uses a client/server architecture.&nbsp; A DPCL "super daemon" is
created each time the user starts a performance tool. This super daemon
is responsible for insuring that a "communication daemon" is running on
each of the machines in the cluster. The super daemon distributes
commands from the performance tool to the various communication daemons
and gathers data from them. TCP/IP is the transport mechanism for this
data in DPCL.<br>
  <br>
The <a href="TroubleShootingGuide/index.html">DPCL
installation
trouble shooting guide</a> provides problem solving information and
tips for the installation of the cluster support component,
DPCL.&nbsp;&nbsp; A quick and dirty list of items to check off if DPCL
is not working is as follows:<br>
  <br>
  </b>
  <div style="margin-left: 40px;"><b style=""><b>Step 1:&nbsp; </b><span
 style="font-weight: bold;">Build Dyninst and DPCL - Here is the script
to build the DPCL and Dyninst</span><br>
##!/bin/tcsh<br>
################################################################################<br>
# DPCL/Dyninst (in directory $HYBRID)<br>
################################################################################<br>
  <br>
setenv DYNINST_ROOT "$HYBRID/dyninst"<br>
  <br>
if ((`uname` == "Linux") &amp;&amp; (`uname -m` == "ia64")) then<br>
&nbsp;&nbsp;&nbsp; setenv PLATFORM "ia64-unknown-linux2.4"<br>
else if (`uname` == "Linux") then<br>
&nbsp;&nbsp;&nbsp; setenv PLATFORM "i386-unknown-linux2.4"<br>
endif<br>
  <br>
cd $DYNINST_ROOT<br>
mkdir -p ${PLATFORM}/bin<br>
mkdir -p ${PLATFORM}/lib<br>
cd $DYNINST_ROOT/core<br>
make DyninstAPI<br>
cd $DYNINST_ROOT<br>
install -d $ROOT/include/dyninst<br>
install -D -m u=rw,g=r,o=r core/dyninstAPI/h/BPatch*.h
$ROOT/include/dyninst<br>
install -D ${PLATFORM}/lib/libdyninstAPI_RT.so.1
$ROOT/lib/libdyninstAPI_RT.so.1<br>
install -D ${PLATFORM}/lib/libdyninstAPI.so $ROOT/lib/libdyninstAPI.so<br>
  <br>
cd $DYNINST_ROOT/../dpcl/src<br>
./configure --prefix=$ROOT --includedir=$ROOT/include/dpcl
--enable-md-dyninst<br>
make<br>
make install<br>
  <br>
unsetenv DYNINST_ROOT<br>
unsetenv PLATFORM<br>
  <br>
cd ../../..<br>
  <br>
  <b>Step 2: Check .rhosts file<br>
  <br>
  </b>Make sure that your login specific .rhosts file has entries for
all the hosts you will be accessing via DPCL.&nbsp; Entries will look
like this: (not the dashed lines)<br>
----------------------------------------<br>
hubble userid<br>
hubble.americas.sgi.com userid<br>
----------------------------------------<br>
  <b><br>
Step 3: dpcl.config file must be present</b><br>
Create a file named dpcl.config in /opt/dpcl/etc that contains the
following two lines: (not the dashed lines)<br>
------------------------------<br>
security:<br>
method = dpcl<br>
------------------------------<br>
  <br>
  <br>
  <b>Step 4: Super Daemon entry in /etc/services<br>
  <br>
  </b>The build mentioned above should install the Super Daemon entry
in /etc/services.&nbsp; If it doesn't proceed with the following.<br>
  <br>
Add the DPCL Super Daemon to the /etc/services file.&nbsp; The line(s)
should be as follows: (not the dashed lines)&nbsp; You can insert it at
the end of the file just above the Local Services area.<br>
-------------------------------------------<br>
# dpcl Super Daemon<br>
dpclSD 7895/tcp # DPCL Super Daemon<br>
-------------------------------------------<br>
  <br>
  <br>
  <b>Step 5:</b>&nbsp; <span style="font-weight: bold;">/etc/xinetd.d/dpclSD
file</span><br>
  <br>
Add the DPCL Super Daemon xinetd.d "dpclSD" file into the /etc/xinetd.d
directory. Here is an example of the file contents needed: (not the
dashed lines)<br>
---------------------------------------------<br>
service dpclSD<br>
{<br>
disable = no<br>
socket_type = stream<br>
protocol = tcp<br>
wait = no<br>
user = root<br>
server = /perftools/ROOT/bin/dpclSD<br>
server_args = /perftools/ROOT/bin/dpcld /tmp/dpcld /tmp/dpcl<br>
env += LD_LIBRARY_PATH=/perftools/ROOT/lib<br>
env += DPCL_RT_LIB=/perftools/ROOT/lib/libdpclRT.so.1<br>
env += DYNINSTAPI_RT_LIB=/perftools/ROOT/lib/libdyninstAPI_RT.so.1<br>
}<br>
---------------------------------------------<br>
  <br>
Change the directory patch to match that of the actual directory path
of the actual DPCL build you want to run.&nbsp; In this example the
DPCL components are in /perftools/ROOT.<br>
  <br>
  <br>
  <b>Step 6:</b> <span style="font-weight: bold;">Activate the Super
Daemon</span><br>
  <br>
Do a: "ps -ef | grep dpcl" to see if any existing super daemons are
running or if there are any hanging daemons.<br>
  <br>
The 'xinetd' daemon must be restarted: "/etc/init.d/xinetd start"at
some point following Open|SpeedShop installation.&nbsp; Doing so allows
'xinetd' to pick up the SuperDaemon (dpclSD) service and start
'listening' on <br>
its port. <br>
  <br>
For Altix: 'kill -SIGHUP `cat /var/run/xinetd.pid`'.&nbsp; When
'xinetd' is restarted, lines similar to the following should appear in
the system file '/var/log/messages':<br>
  <br>
  </b>
  <pre wrap=""><b style="">  .... xinetd[617]: Starting reconfiguration<br>  <br>  .... xinetd[617]: readjusting service dpclSD<br><br><br></b></pre>
  <b style="">Do the following command once the xinetd daemon has been
restarted, per
the TroubleShooting Guide.&nbsp; This will tell you if the Super Daemon
is running.<br>
  <br>
"netstat -a -inet | grep dpclSD" <br>
or<br>
"netstat -a -inet" yields this type of list:<br>
  <br>
Active Internet connections (servers and established)<br>
Proto Recv-Q Send-Q Local
Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
State<br>
tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0
*:32768&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN<br>
tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0
*:login&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN<br>
tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 localhost.localdo:32769
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN<br>
...<br>
...<br>
tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0
*:telnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN<br>
  <b>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0
*:dpclSD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN</b><br>
tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0
*:smtp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LISTEN</b></div>
</blockquote>
<b style=""><br>
</b>
</body>
</html>
